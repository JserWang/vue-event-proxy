"use strict";Object.defineProperty(exports,"__esModule",{value:true});var _slicedToArray=function(){function t(r,e){var t=[];var n=true;var o=false;var i=undefined;try{for(var a=r[Symbol.iterator](),u;!(n=(u=a.next()).done);n=true){t.push(u.value);if(e&&t.length===e)break}}catch(r){o=true;i=r}finally{try{if(!n&&a["return"])a["return"]()}finally{if(o)throw i}}return t}return function(r,e){if(Array.isArray(r)){return r}else if(Symbol.iterator in Object(r)){return t(r,e)}else{throw new TypeError("Invalid attempt to destructure non-iterable instance")}}}();function plugin(r){var e=Number(r.version.split(".")[0]);var i=function r(){};if(e<2){console.error("[vue-event-proxy] only support Vue 2.0+");return}if(plugin.installed){return}plugin.installed=true;var l={};var a={};var f=/^global:/;function t(r){var o=r.prototype.$on;r.prototype.$on=function r(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:i;var n=this;if(Array.isArray(e)){e.forEach(function(r){n.$on(r,t)})}else{if(f.test(e)){(a[n._uid]||(a[n._uid]=[])).push(e);(l[e]||(l[e]=[])).push(n)}o.call(n,e,t)}return n};var u=r.prototype.$emit;r.prototype.$emit=function r(e){for(var t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++){n[o-1]=arguments[o]}var i=this;if(!i._fromGlobalEvent&&f.test(e)){var a=l[e]||[];a.forEach(function(r){r._fromGlobalEvent=true;r.$emit.apply(r,[e].concat(n));r._fromGlobalEvent=false})}else{u.apply(i,[e].concat(n))}return i}}function n(r){r.mixin({beforeCreate:function r(){this._fromGlobalEvent=false},beforeDestroy:function r(){var t=this;var e=a[t._uid]||[];e.forEach(function(r){var e=l[r].findIndex(function(r){return r._uid===t._uid});l[r].splice(e,1)});delete a[t._uid];Object.entries(l).forEach(function(r){var e=_slicedToArray(r,2),t=e[0],n=e[1];return n.length||delete l[t]})}})}t(r);n(r)}exports.default=plugin;